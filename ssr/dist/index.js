var W=Object.defineProperty;var j=(t,e,n)=>e in t?W(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var c=(t,e,n)=>(j(t,typeof e!="symbol"?e+"":e,n),n);const H=t=>["circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","switch","symbol","text","textPath","title","tspan","use","view"].includes(t),m=(t,e)=>{let n;const r=Object.keys(e);for(n of r)t.style[n]=e[n]},A=(t,e)=>{if(e instanceof HTMLElement||e instanceof Text)p(t,e)&&t.appendChild(e);else if(typeof e=="object"){if(e&&e instanceof h){const n=document.createTextNode(e.value.toString());e.addStateChangeEvent(r=>{n.textContent=r.toString()}),p(t)&&t.appendChild(n)}}else typeof e=="string"||typeof e=="number"||typeof e=="boolean"?p(t)&&t.appendChild(document.createTextNode(e.toString())):console.warn("Unknown type to append: ",e)},P=(t,e)=>{for(const n of e)if(!(!n&&n!==0))if(Array.isArray(n))for(const r of n)Array.isArray(r)?P(t,r):A(t,r);else A(t,n)};class h{constructor(e){c(this,"onStateChange");c(this,"value");c(this,"onTerminate");this.value=e,this.onStateChange=[],this.onTerminate=null}toString(){return this.value}addStateChangeEvent(e){this.onStateChange.push(e)}distributeNewState(e){this.value=e,this.onStateChange.forEach(n=>n(e))}terminate(){var e;(e=this.onTerminate)==null||e.call(this),this.onStateChange=[]}}const N=t=>{let e=new h(t);return r=>{if(r!==void 0){const i=r instanceof Function?r(e.value):r;e.distributeNewState(i)}return e}},O=(t,e)=>{e.length,e.forEach(n=>{n.addStateChangeEvent(t)})},M=t=>t instanceof Function?t()instanceof h:!1,y=t=>M(t)?t.value:t,b=t=>t instanceof HTMLElement||t instanceof SVGElement||t instanceof Text||typeof t=="string",D=(t,e)=>{const n=e.map(o=>o.value);let r=t(...n);(Array.isArray(r)&&!r.reduce((o,a)=>o&&b(a),!0)||!Array.isArray(r)&&!b(r))&&(r=document.createTextNode(r+""));const i=(o,a)=>{n[a]=o;const l=t(...n);!r||!l||(r instanceof Text?l instanceof HTMLElement||l instanceof SVGElement||l instanceof Text?r.replaceWith(l):r.data=l+"":p(r,l)&&(V(r,l),r=l))};return e.forEach((o,a)=>{o.addStateChangeEvent(l=>i(l,a))}),r},w=()=>s("span",{},["404 page not found"]),F=t=>t.trim().replace(/^\/*/,"").replace(/\/*$/g,""),v=t=>!Array.isArray(t)&&t!==null||Array.isArray(t)&&t.length!==0,d=(t,e,n)=>{const r=F(n.path),i=e+(e==="/"?"":"/")+r;if(t===i)return n.element();if(r.endsWith("*")){const l=t.replace(e,"").split("/")[0],f=r.substring(0,r.length-1);if(l.startsWith(f)){for(let g=0;g<n.nested.length;g++){const E=d(t,e+(e==="/"?"":"/")+l,n.nested[g]);if(v(E))return E}if(t.replace(e,"").split("/").length===1)return n.element()}return null}if(t.startsWith(i))for(let o=0;o<n.nested.length;o++){const a=d(t,i,n.nested[o]);if(a!==null)return a}return null},u=N("/");class C{constructor(e,n,r){c(this,"path");c(this,"element");c(this,"nested");this.path=e,this.element=n,this.nested=r}}const G=t=>{const{children:e,onRouteChange:n}=t,r=location.pathname;u(r),window.addEventListener("popstate",o=>{const a=o.currentTarget.location.pathname;u(a)});const i=o=>{if(Array.isArray(e)){for(let a=0;a<e.length;a++)if(e[a]instanceof C){const l=d(o,"/",e[a]);if(v(l))return l}return w()}if(e instanceof C){const a=d(o,"/",e);if(v(a))return a}return w()};return n?(O(()=>{const o=i(u().value);n(o)},[u()]),i(u().value)):D(i,[u()])},T=t=>{const{path:e,content:n,children:r}=t;return new C(e,n,r?Array.isArray(r)?r:[r]:[])},I=({children:t,href:e})=>s("a",{onClick:r=>{r.preventDefault();const i=M(e)?e.value:e;u(i),window.history.pushState({},"",i)},href:y(e)},t),V=(t,e)=>{if(Array.isArray(t))if(Array.isArray(e)){for(let n=1;n<t.length;n++)t[n].remove();t[0].replaceWith(e[0]);for(let n=e.length-1;n>0;n--)e[0].after(e[n])}else{for(let n=1;n<t.length;n++)t[n].remove();t[0].replaceWith(e)}else if(Array.isArray(e)){t.replaceWith(e[0]);for(let n=e.length-1;n>0;n--)e[0].after(e[n])}else t.replaceWith(e)},p=(...t)=>t.reduce((e,n)=>e&&(n instanceof HTMLElement||n instanceof SVGElement||n instanceof Text),!0),s=(t,e,...n)=>{if(typeof t=="function")return t({...e,children:n.length===1?n[0]:n});const i=H(t)?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);if(e){e.style&&typeof e.style=="object"&&(e.style instanceof h?(e.style.addStateChangeEvent(a=>{m(i,a)}),m(i,e.style.value)):m(i,e.style),delete e.style);for(let[o,a]of Object.entries(e))if(o==="ref")a.distributeNewState(i);else if(a instanceof h){i.setAttribute(o,a.value);const l=f=>{i.setAttribute(o,f)};a.addStateChangeEvent(l)}else if(o.startsWith("on")){o==="onChange"&&(o="onInput");const l=o.replace(/Capture$/,""),f=o!==l,S=l.toLowerCase().substring(2);a&&typeof a=="function"&&i.addEventListener(S,a,f)}else a===!0?i.setAttribute(o,o):(a||a===0)&&i.setAttribute(o,a.toString())}return P(i,n),i},x=async t=>{t instanceof Promise&&(t=await t),t.childNodes.forEach(e=>{if(e.nodeName==="BODY"){const n=document.getElementById("_LAMPJS_DATA_");document.body.replaceWith(e),n&&document.body.appendChild(n)}if(e.nodeName==="HEAD"){const n=[],r=document.createElement("script");r.type="module",r.src="/index.js",document.addEventListener("DOMContentLoaded",()=>{Array.from(document.head.childNodes).forEach(o=>{(o instanceof HTMLStyleElement&&o.type==="text/css"||o instanceof HTMLLinkElement&&o.rel==="stylesheet"||o instanceof HTMLTitleElement)&&n.push(o)}),document.head.replaceWith(e),document.head.appendChild(r),n.forEach(o=>document.head.appendChild(o))})}})};function B(t,e,n){const{children:r}=t;return s(G,{onRouteChange:o=>{x(o)}},...k(r))}function k(t){return Array.isArray(t)?t:[t]}function R({children:t,href:e,revalidate:n},r,i){const o=k(t);return n?s("a",{href:y(e)},...o):s(I,{href:y(e)},...o)}const $=()=>{const t=N(0);return s("button",{onClick:()=>t(e=>e+1)},"Count is ",t())},J=()=>s("div",{class:"root"},s("img",{src:"/lamp.svg",alt:"LampJs Icon"}),s("h1",null,"LampJs"),s("span",null,"A powerful, lightweight JS framework"),s($,null),s(R,{href:"/about"},"about")),_=()=>s("div",{class:"root"},s("h1",null,"about"),s(R,{href:"/"},"home")),L=({children:t})=>s("html",{lang:"en"},s("head",null,s("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),s("meta",{name:"description",content:"Server side rendering !!!"}),s("title",null,"test")),s("body",null,t)),U=()=>s(B,null,s(T,{path:"/",content:()=>s(L,null,s(J,null))}),s(T,{path:"/about",content:()=>s(L,null,s(_,null))}));x(s(U,null));
